#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: 01_client_interaction</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/d5a/md__2github_2workspace_2ecosystem_2ai-tools_2beacon_2content_2resilientdb_2chapters_201__client__interaction.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">01_client_interaction</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr  />
<p> layout: default title: 'Chapter 1: Client Interaction' parent: 'ResilientDB' </p>
<h2><a class="anchor" id="autotoc_md84"></a>
nav_order: 1</h2>
<h1><a class="anchor" id="autotoc_md85"></a>
Chapter 1: Client Interaction</h1>
<p>Welcome to your first step in understanding ResilientDB! Imagine ResilientDB is a powerful, secure, and reliable database system run by a team of computers working together. How do you, as a user or an application developer, talk to this system? You can't just shout commands into the void! You need a defined way to communicate, like using a customer service counter at a bank or an API (Application Programming Interface) for a website.</p>
<p>This chapter introduces the <b>Client Interaction</b> layer of ResilientDB. It's the set of tools and libraries that act as that "customer service counter" or API, allowing you to:</p>
<ul>
<li>Send requests (we call these <b>transactions</b>) to the ResilientDB network.</li>
<li>Receive results back from the network.</li>
</ul>
<p>Think of it as the official "front door" for interacting with ResilientDB, hiding all the complex machinery working behind the scenes.</p>
<h2><a class="anchor" id="autotoc_md86"></a>
Why Do We Need Special Clients?</h2>
<p>ResilientDB isn't just one program running on one computer. It's a <em>distributed</em> system, meaning multiple computers (called replicas or nodes) work together to store data and agree on changes. Sending a simple request like "store this value" involves:</p>
<ol type="1">
<li>Formatting your request correctly.</li>
<li>Finding the right node(s) in the network to send it to.</li>
<li>Sending the message reliably over the network.</li>
<li>Waiting for enough nodes in the network to agree on your request (this is called consensus).</li>
<li>Getting a confirmation or result back.</li>
</ol>
<p>Doing all this manually would be complicated and error-prone! The Client Interaction layer provides tools (<b>Clients</b>) that handle these steps for you.</p>
<h2><a class="anchor" id="autotoc_md87"></a>
Meet the ResilientDB Clients: Different Counters for Different Tasks</h2>
<p>ResilientDB offers different types of clients, each specialized for a particular kind of interaction, just like a bank might have different counters for deposits, loans, or inquiries.</p>
<ol type="1">
<li><b><code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> (Key-Value Client):</b><ul>
<li><b>What it does:</b> Allows you to store and retrieve simple data as key-value pairs, like a dictionary or a basic lookup table. You provide a unique <code>key</code> (like a word) and associate a <code>value</code> (like its definition) with it.</li>
<li><b>Analogy:</b> Think of it as a super-reliable set of digital storage lockers. Each locker has a unique key, and you can put something (a value) inside or check what's inside using the key.</li>
<li><b>Use Case:</b> Storing user preferences, configuration settings, simple records.</li>
</ul>
</li>
<li><b><code><a class="el" href="../../dc/d2f/classUTXOClient.html">UTXOClient</a></code> (Unspent <a class="el" href="../../df/d28/classTransaction.html">Transaction</a> Output Client):</b><ul>
<li><b>What it does:</b> Designed for managing and transferring digital assets or tokens within ResilientDB, using the UTXO model (common in cryptocurrencies like Bitcoin).</li>
<li><b>Analogy:</b> This is like a bank teller specifically for transferring funds. You tell them which "coins" (UTXOs) you want to send and who should receive them.</li>
<li><b>Use Case:</b> Building applications involving token transfers or digital asset management.</li>
</ul>
</li>
<li><b><code><a class="el" href="../../d5/df9/classContractClient.html">ContractClient</a></code> (Smart Contract Client):</b><ul>
<li><b>What it does:</b> Interacts with "smart contracts" deployed on the ResilientDB network. Smart contracts are like small programs stored on the blockchain that automatically execute predefined rules and logic.</li>
<li><b>Analogy:</b> Imagine a sophisticated vending machine. You don't just store items; you interact with the machine's programmed logic (select item, insert payment, receive item and change) by calling specific functions.</li>
<li><b>Use Case:</b> Running decentralized applications (dApps), automating complex agreements, enforcing business logic on the blockchain.</li>
</ul>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md88"></a>
The Foundation: <code>TransactionConstructor</code></h2>
<p>While we have specialized clients (<code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code>, <code><a class="el" href="../../dc/d2f/classUTXOClient.html">UTXOClient</a></code>, <code><a class="el" href="../../d5/df9/classContractClient.html">ContractClient</a></code>), they all share common tasks: creating the request message in the right format, sending it over the network, and handling the response.</p>
<p>The <code>TransactionConstructor</code> is a fundamental building block (a base class in programming terms) that provides this core functionality. Each specific client (<code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code>, etc.) builds upon <code>TransactionConstructor</code> to handle the details of its specific task.</p>
<ul>
<li><b>Analogy:</b> Think of <code>TransactionConstructor</code> as providing the standard request form and the basic instructions for mailing it. The specific clients (<code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code>, etc.) know how to fill out the form for their particular request (storing data, transferring assets, calling a contract).</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// Simplified view from interface/rdbc/transaction_constructor.h</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d5/d10/namespaceresdb.html">resdb</a> {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Provides the basic tools to send requests and receive responses.</span></div>
<div class="line"><span class="keyword">class </span>TransactionConstructor : <span class="keyword">public</span> NetChannel { <span class="comment">// Inherits network abilities</span></div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">// Constructor needs configuration (where are the ResilientDB nodes?)</span></div>
<div class="line">  <a class="code hl_function" href="../../d0/da5/classresdb_1_1TransactionConstructor.html#ac1de2bffadf5aad20407b7999f7b1b9c">TransactionConstructor</a>(<span class="keyword">const</span> <a class="code hl_class" href="../../d6/d06/classResDBConfig.html">ResDBConfig</a>&amp; <a class="code hl_namespace" href="../../d6/d7f/namespaceconfig.html">config</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Sends a request message (doesn&#39;t wait for a detailed reply)</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_function" href="../../d0/da5/classresdb_1_1TransactionConstructor.html#a16fb166890904f6e6466aa552e771e82">SendRequest</a>(<span class="keyword">const</span> google::protobuf::Message&amp; message,</div>
<div class="line">                  Request::Type type = Request::TYPE_CLIENT_REQUEST);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Sends a request message AND waits to receive a response message</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_function" href="../../d0/da5/classresdb_1_1TransactionConstructor.html#a16fb166890904f6e6466aa552e771e82">SendRequest</a>(<span class="keyword">const</span> google::protobuf::Message&amp; message,</div>
<div class="line">                  google::protobuf::Message* response, <span class="comment">// Place to store the response</span></div>
<div class="line">                  Request::Type type = Request::TYPE_CLIENT_REQUEST);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ... other helper functions ...</span></div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_class" href="../../d6/d06/classResDBConfig.html">ResDBConfig</a> config_; <span class="comment">// Stores network configuration</span></div>
<div class="line">  <span class="comment">// NetChannel handles low-level network sending/receiving details</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace resdb</span></div>
<div class="ttc" id="aclassResDBConfig_html"><div class="ttname"><a href="../../d6/d06/classResDBConfig.html">ResDBConfig</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d9a/resdb__config_8h_source.html#l00028">resdb_config.h:28</a></div></div>
<div class="ttc" id="aclassresdb_1_1TransactionConstructor_html_a16fb166890904f6e6466aa552e771e82"><div class="ttname"><a href="../../d0/da5/classresdb_1_1TransactionConstructor.html#a16fb166890904f6e6466aa552e771e82">resdb::TransactionConstructor::SendRequest</a></div><div class="ttdeci">int SendRequest(const google::protobuf::Message &amp;message, Request::Type type=Request::TYPE_CLIENT_REQUEST)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dfc/transaction__constructor_8cpp_source.html#l00063">transaction_constructor.cpp:63</a></div></div>
<div class="ttc" id="aclassresdb_1_1TransactionConstructor_html_ac1de2bffadf5aad20407b7999f7b1b9c"><div class="ttname"><a href="../../d0/da5/classresdb_1_1TransactionConstructor.html#ac1de2bffadf5aad20407b7999f7b1b9c">resdb::TransactionConstructor::TransactionConstructor</a></div><div class="ttdeci">TransactionConstructor(const ResDBConfig &amp;config)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dfc/transaction__constructor_8cpp_source.html#l00026">transaction_constructor.cpp:26</a></div></div>
<div class="ttc" id="anamespaceconfig_html"><div class="ttname"><a href="../../d6/d7f/namespaceconfig.html">config</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0d/ai-tools_2mcp_2resilientdb-mcp_2config_8py_source.html#l00001">config.py:1</a></div></div>
<div class="ttc" id="anamespaceresdb_html"><div class="ttname"><a href="../../d5/d10/namespaceresdb.html">resdb</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d85/chain__state_8cpp_source.html#l00024">chain_state.cpp:24</a></div></div>
</div><!-- fragment --><p>This code shows that <code>TransactionConstructor</code> takes the ResilientDB network configuration (<code><a class="el" href="../../d6/d06/classResDBConfig.html">ResDBConfig</a></code>) and provides <code>SendRequest</code> methods. It uses something called <code>NetChannel</code> internally, which we'll explore more in the next chapter about Network Communication (ReplicaCommunicator / ServiceNetwork).</p>
<h2><a class="anchor" id="autotoc_md89"></a>
How it Works: A <code>KVClient</code> Example (Set &amp; Get)</h2>
<p>Let's walk through a simple example: storing and retrieving a greeting using <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code>.</p>
<p><b>Goal:</b> Store the key <code>"greeting"</code> with the value <code>"Hello ResilientDB!"</code> and then retrieve it.</p>
<p><b>Step 1: The User Application Code (Conceptual)</b></p>
<p>Your application decides it needs to store this data. It will use the <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code>.</p>
<p><b>Step 2: Using <code><a class="el" href="../../d6/da5/classKVClient.html#a51f8f8bb730c43c71e97c9c7777a11fd">KVClient::Set</a></code></b></p>
<p>Your application calls the <code>Set</code> method on a <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> object.</p>
<div class="fragment"><div class="line"><span class="comment">// Inside your application (conceptual C++)</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d8/d48/kv__client_8h.html">interface/kv/kv_client.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/d9a/resdb__config_8h.html">platform/config/resdb_config.h</a>&quot;</span> <span class="comment">// For configuration</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Assume &#39;config&#39; holds the network details</span></div>
<div class="line"><a class="code hl_class" href="../../db/ddb/classresdb_1_1ResDBConfig.html">resdb::ResDBConfig</a> <a class="code hl_namespace" href="../../d6/d7f/namespaceconfig.html">config</a> = ...;</div>
<div class="line"><a class="code hl_class" href="../../d4/dbb/classresdb_1_1KVClient.html">resdb::KVClient</a> kv_client(<a class="code hl_namespace" href="../../d6/d7f/namespaceconfig.html">config</a>); <span class="comment">// Create the client</span></div>
<div class="line"> </div>
<div class="line">std::string my_key = <span class="stringliteral">&quot;greeting&quot;</span>;</div>
<div class="line">std::string my_value = <span class="stringliteral">&quot;Hello ResilientDB!&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> result = kv_client.Set(my_key, my_value); <span class="comment">// Call the client method</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (result == 0) {</div>
<div class="line">  <span class="comment">// Success!</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// Something went wrong</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassresdb_1_1KVClient_html"><div class="ttname"><a href="../../d4/dbb/classresdb_1_1KVClient.html">resdb::KVClient</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d48/kv__client_8h_source.html#l00028">kv_client.h:28</a></div></div>
<div class="ttc" id="aclassresdb_1_1ResDBConfig_html"><div class="ttname"><a href="../../db/ddb/classresdb_1_1ResDBConfig.html">resdb::ResDBConfig</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d9a/resdb__config_8h_source.html#l00028">resdb_config.h:28</a></div></div>
<div class="ttc" id="akv__client_8h_html"><div class="ttname"><a href="../../d8/d48/kv__client_8h.html">kv_client.h</a></div></div>
<div class="ttc" id="aresdb__config_8h_html"><div class="ttname"><a href="../../d4/d9a/resdb__config_8h.html">resdb_config.h</a></div></div>
</div><!-- fragment --><p>What happens inside <code><a class="el" href="../../d6/da5/classKVClient.html#a51f8f8bb730c43c71e97c9c7777a11fd">KVClient::Set</a></code>?</p>
<div class="fragment"><div class="line"><span class="comment">// Simplified from interface/kv/kv_client.cpp</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../d6/da5/classKVClient.html#a51f8f8bb730c43c71e97c9c7777a11fd">KVClient::Set</a>(<span class="keyword">const</span> std::string&amp; key, <span class="keyword">const</span> std::string&amp; data) {</div>
<div class="line">  <span class="comment">// 1. Create a specific request message for Key-Value operations</span></div>
<div class="line">  KVRequest request;</div>
<div class="line">  request.set_cmd(KVRequest::SET); <span class="comment">// Indicate the command is &quot;SET&quot;</span></div>
<div class="line">  request.set_key(key);            <span class="comment">// Put the key in the message</span></div>
<div class="line">  request.set_value(data);         <span class="comment">// Put the value in the message</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// 2. Use TransactionConstructor&#39;s ability to send the request</span></div>
<div class="line">  <span class="comment">//    This sends the &#39;request&#39; message to the network.</span></div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_function" href="../../d0/da5/classresdb_1_1TransactionConstructor.html#a16fb166890904f6e6466aa552e771e82">SendRequest</a>(request); <span class="comment">// This method comes from TransactionConstructor</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassKVClient_html_a51f8f8bb730c43c71e97c9c7777a11fd"><div class="ttname"><a href="../../d6/da5/classKVClient.html#a51f8f8bb730c43c71e97c9c7777a11fd">KVClient::Set</a></div><div class="ttdeci">int Set(const std::string &amp;key, const std::string &amp;data, int version)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d6d/kv__client_8cpp_source.html#l00065">kv_client.cpp:65</a></div></div>
</div><!-- fragment --><p>The <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> prepares a <code>KVRequest</code> message, filling it with the command (<code>SET</code>), key, and value. Then, it uses the <code>SendRequest</code> method inherited from <code>TransactionConstructor</code> to actually send it.</p>
<p><b>Step 3: Using <code><a class="el" href="../../d6/da5/classKVClient.html#abf116a590c3c36a16dc4adf3b3ffee35">KVClient::Get</a></code></b></p>
<p>Now, your application wants to retrieve the value associated with <code>"greeting"</code>.</p>
<div class="fragment"><div class="line"><span class="comment">// Inside your application (conceptual C++)</span></div>
<div class="line">std::unique_ptr&lt;std::string&gt; retrieved_value_ptr = kv_client.Get(my_key);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (retrieved_value_ptr != <span class="keyword">nullptr</span>) {</div>
<div class="line">  std::string value = *retrieved_value_ptr;</div>
<div class="line">  <span class="comment">// Now &#39;value&#39; should be &quot;Hello ResilientDB!&quot;</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// Key not found or error occurred</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>What happens inside <code><a class="el" href="../../d6/da5/classKVClient.html#abf116a590c3c36a16dc4adf3b3ffee35">KVClient::Get</a></code>?</p>
<div class="fragment"><div class="line"><span class="comment">// Simplified from interface/kv/kv_client.cpp</span></div>
<div class="line">std::unique_ptr&lt;std::string&gt; <a class="code hl_function" href="../../d6/da5/classKVClient.html#abf116a590c3c36a16dc4adf3b3ffee35">KVClient::Get</a>(<span class="keyword">const</span> std::string&amp; key) {</div>
<div class="line">  <span class="comment">// 1. Create a specific request message for Key-Value operations</span></div>
<div class="line">  KVRequest request;</div>
<div class="line">  request.set_cmd(KVRequest::GET); <span class="comment">// Indicate the command is &quot;GET&quot;</span></div>
<div class="line">  request.set_key(key);            <span class="comment">// Put the key we are looking for</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// 2. Prepare a place to receive the response</span></div>
<div class="line">  KVResponse response;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// 3. Use TransactionConstructor to send the request AND wait for a response</span></div>
<div class="line">  <span class="keywordtype">int</span> ret = <a class="code hl_function" href="../../d0/da5/classresdb_1_1TransactionConstructor.html#a16fb166890904f6e6466aa552e771e82">SendRequest</a>(request, &amp;response); <span class="comment">// Note the &#39;&amp;response&#39; part</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">    LOG(ERROR) &lt;&lt; <span class="stringliteral">&quot;send request fail, ret:&quot;</span> &lt;&lt; ret;</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>; <span class="comment">// Return null on error</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// 4. Extract the value from the received response message</span></div>
<div class="line">  <span class="keywordflow">return</span> std::make_unique&lt;std::string&gt;(response.value());</div>
<div class="line">}</div>
<div class="ttc" id="aclassKVClient_html_abf116a590c3c36a16dc4adf3b3ffee35"><div class="ttname"><a href="../../d6/da5/classKVClient.html#abf116a590c3c36a16dc4adf3b3ffee35">KVClient::Get</a></div><div class="ttdeci">std::unique_ptr&lt; ValueInfo &gt; Get(const std::string &amp;key, int version)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d6d/kv__client_8cpp_source.html#l00075">kv_client.cpp:75</a></div></div>
</div><!-- fragment --><p>This time, <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> creates a <code>KVRequest</code> with the <code>GET</code> command and the key. It then calls the <code>SendRequest</code> method from <code>TransactionConstructor</code> that <em>waits</em> for a response and puts the result into the <code>response</code> object. If successful, it extracts the value from the <code>KVResponse</code> and returns it.</p>
<p><b>Step 4: Under the Hood (Simplified Flow)</b></p>
<p>This diagram shows the interaction flow:</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant UserApp as User Application</div>
<div class="line">    participant Client as KVClient</div>
<div class="line">    participant TxConstructor as TransactionConstructor</div>
<div class="line">    participant ResDBNode as ResilientDB Network Node</div>
<div class="line"> </div>
<div class="line">    UserApp-&gt;&gt;+Client: Set(&quot;greeting&quot;, &quot;Hello!&quot;)</div>
<div class="line">    Client-&gt;&gt;TxConstructor: Create KVRequest (SET command)</div>
<div class="line">    Note right of Client: Fills request with key &amp; value</div>
<div class="line">    TxConstructor-&gt;&gt;+ResDBNode: Send Request Message (via NetChannel)</div>
<div class="line">    Note right of ResDBNode: Network Magic!&lt;br/&gt;Nodes receive, agree (consensus),&lt;br/&gt;execute (store data), prepare reply.&lt;br/&gt;(See Chapters 2-6)</div>
<div class="line">    ResDBNode--&gt;&gt;-TxConstructor: Send Response Message (Success/Fail)</div>
<div class="line">    TxConstructor--&gt;&gt;Client: Return result from SendRequest (e.g., 0)</div>
<div class="line">    Client--&gt;&gt;-UserApp: Return result (0)</div>
<div class="line"> </div>
<div class="line">    UserApp-&gt;&gt;+Client: Get(&quot;greeting&quot;)</div>
<div class="line">    Client-&gt;&gt;TxConstructor: Create KVRequest (GET command)</div>
<div class="line">    Note right of Client: Fills request with key</div>
<div class="line">    TxConstructor-&gt;&gt;+ResDBNode: Send Request Message (via NetChannel)</div>
<div class="line">    Note right of ResDBNode: Network Magic!&lt;br/&gt;Nodes receive, agree (consensus),&lt;br/&gt;execute (read data), prepare reply.&lt;br/&gt;(See Chapters 2-6)</div>
<div class="line">    ResDBNode--&gt;&gt;-TxConstructor: Send Response Message (with value)</div>
<div class="line">    TxConstructor-&gt;&gt;Client: Parse Response, fill KVResponse object</div>
<div class="line">    Note right of Client: Extracts value from KVResponse</div>
<div class="line">    Client--&gt;&gt;-UserApp: Return value (&quot;Hello!&quot;)</div>
</div><!-- fragment --><p>The key takeaway is that <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> and <code>TransactionConstructor</code> work together to hide the complexities of network communication, consensus ([Consensus Management (ConsensusManager)](03_consensus_management)), transaction execution ([<a class="el" href="../../df/d28/classTransaction.html">Transaction</a> Execution (TransactionManager / TransactionExecutor)](05_transaction_execution__transactionmanager)), and storage ([Storage Layer (Storage / LevelDB / MemoryDB)](06_storage_layer)).</p>
<h2><a class="anchor" id="autotoc_md90"></a>
Making it Easy: Python Example</h2>
<p>ResilientDB also provides Python bindings, making it accessible for Python developers without needing to write C++.</p>
<div class="fragment"><div class="line"><span class="comment"># From api/kv_operation.py (slightly annotated)</span></div>
<div class="line"><span class="keyword">import</span> os</div>
<div class="line"><span class="comment"># This &#39;pybind_kv&#39; is the magic link between Python and the C++ KVClient</span></div>
<div class="line"><span class="keyword">import</span> pybind_kv</div>
<div class="line"><span class="comment"># Get the directory where this script is located for finding the config file</span></div>
<div class="line">current_dir = os.path.dirname(os.path.abspath(__file__))</div>
<div class="line"><span class="comment"># Default config tells the client where the ResilientDB nodes are</span></div>
<div class="line"><span class="comment"># More on config in Chapter 8: [ResilientDB Configuration (ResDBConfig)](08_resilientdb_configuration__resdbconfig_.md)</span></div>
<div class="line">default_config = os.path.join(current_dir, <span class="stringliteral">&quot;ip_address.config&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>set_value(key: str, value: str, config_path: str = default_config) -&gt; bool:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Sets a key-value pair.&quot;&quot;&quot;</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;Python: Calling C++ set(key=&#39;{key}&#39;, value=&#39;{value}&#39;)...&quot;</span>)</div>
<div class="line">    <span class="comment"># This calls the C++ KVClient::Set method via the pybind_kv bridge</span></div>
<div class="line">    success = pybind_kv.set(str(key), str(value), os.path.abspath(config_path))</div>
<div class="line">    print(f<span class="stringliteral">&quot;Python: C++ set operation successful: {success}&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> success</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>get_value(key: str, config_path: str = default_config) -&gt; str:</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Gets the value for a key.&quot;&quot;&quot;</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;Python: Calling C++ get(key=&#39;{key}&#39;)...&quot;</span>)</div>
<div class="line">    <span class="comment"># This calls the C++ KVClient::Get method via the pybind_kv bridge</span></div>
<div class="line">    value = pybind_kv.get(str(key), os.path.abspath(config_path))</div>
<div class="line">    print(f<span class="stringliteral">&quot;Python: C++ get operation returned: &#39;{value}&#39;&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> value</div>
<div class="line"> </div>
<div class="line"><span class="comment"># --- Example of using these Python functions ---</span></div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    key_to_use = <span class="stringliteral">&quot;python_test_key&quot;</span></div>
<div class="line">    value_to_set = <span class="stringliteral">&quot;Hello from Python!&quot;</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> set_value(key_to_use, value_to_set):</div>
<div class="line">        retrieved = get_value(key_to_use)</div>
<div class="line">        <span class="keyword">assert</span> retrieved == value_to_set <span class="comment"># Check if it worked</span></div>
<div class="line">        print(<span class="stringliteral">&quot;\nSuccessfully set and got value using Python!&quot;</span>)</div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        print(<span class="stringliteral">&quot;\nFailed to set value using Python.&quot;</span>)</div>
</div><!-- fragment --><p>This Python code uses the <code>pybind_kv</code> module, which internally calls the C++ <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> functions (<code>Set</code> and <code>Get</code>) that we discussed earlier. It provides a simple, high-level interface for Python users. Notice the <code>config_path</code> - this tells the client how to find the ResilientDB network nodes, a topic covered in ResilientDB Configuration (ResDBConfig).</p>
<h2><a class="anchor" id="autotoc_md91"></a>
Conclusion</h2>
<p>You've learned about the crucial Client Interaction layer in ResilientDB. It's the bridge between your application and the powerful distributed network.</p>
<ul>
<li>We saw that specialized clients like <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code>, <code><a class="el" href="../../dc/d2f/classUTXOClient.html">UTXOClient</a></code>, and <code><a class="el" href="../../d5/df9/classContractClient.html">ContractClient</a></code> provide easy-to-use interfaces for different tasks.</li>
<li>We learned that <code>TransactionConstructor</code> is the underlying engine that handles the common work of preparing and sending requests.</li>
<li>We walked through a simple <code><a class="el" href="../../d6/da5/classKVClient.html">KVClient</a></code> example (<code>Set</code> and <code>Get</code>) to see how the client hides the complexity of interacting with the distributed system.</li>
<li>We saw how Python bindings make these C++ clients accessible to Python developers.</li>
</ul>
<p>Now that you understand <em>how</em> to formulate a request and initiate communication using clients, you might be wondering: what happens next? How does that request actually travel across the network to the ResilientDB nodes?</p>
<p>That's exactly what we'll cover in the next chapter!</p>
<p><b>Next:</b> [Chapter 2: Network Communication](02_network_communication)</p>
<hr  />
<p>Generated by <a href="https://github.com/The-Pocket/Tutorial-Codebase-Knowledge">AI Codebase Knowledge Builder</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
