#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: nft_market</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d4/d01/md__2github_2workspace_2ecosystem_2graphql_2docs_2nft__market.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">nft_market</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p># </p>
<h1><a class="anchor" id="autotoc_md186"></a>
Licensed to the Apache Software Foundation (ASF) under one</h1>
<h1><a class="anchor" id="autotoc_md187"></a>
or more contributor license agreements. See the NOTICE file</h1>
<h1><a class="anchor" id="autotoc_md188"></a>
distributed with this work for additional information</h1>
<h1><a class="anchor" id="autotoc_md189"></a>
regarding copyright ownership. The ASF licenses this file</h1>
<h1><a class="anchor" id="autotoc_md190"></a>
to you under the Apache License, Version 2.0 (the</h1>
<h1><a class="anchor" id="autotoc_md191"></a>
"License"); you may not use this file except in compliance</h1>
<h1><a class="anchor" id="autotoc_md192"></a>
with the License. You may obtain a copy of the License at</h1>
<p># </p>
<h1><a class="anchor" id="autotoc_md193"></a>
<a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></h1>
<p># </p>
<h1><a class="anchor" id="autotoc_md194"></a>
Unless required by applicable law or agreed to in writing,</h1>
<h1><a class="anchor" id="autotoc_md195"></a>
software distributed under the License is distributed on an</h1>
<h1><a class="anchor" id="autotoc_md196"></a>
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</h1>
<h1><a class="anchor" id="autotoc_md197"></a>
KIND, either express or implied. See the License for the</h1>
<h1><a class="anchor" id="autotoc_md198"></a>
specific language governing permissions and limitations</h1>
<h1><a class="anchor" id="autotoc_md199"></a>
under the License.</h1>
<p>#</p>
<h1><a class="anchor" id="autotoc_md200"></a>
Building a NFT market with resdb</h1>
<h2><a class="anchor" id="autotoc_md201"></a>
How can Sajjad sell his painting to Mo?</h2>
<ol type="1">
<li>Sajjad registers his painting as an immutable asset of which he has ownership</li>
<li>While registering the asset he would need to share some immutable info such as <code>name of painting</code>, <code>date of creation</code>, <code>painter</code> ect.</li>
<li>Optional metadata can be added as well about things like <code>price</code>, <code>currency</code> ect.</li>
</ol>
<ol type="1">
<li>Upload the NFT publicly for everyone to see</li>
<li>Sell the NFT to Mo</li>
</ol>
<h3><a class="anchor" id="autotoc_md202"></a>
The above process in terms of transactions</h3>
<ol type="1">
<li>Creating the NFT = <code>CREATE</code> transaction</li>
<li>Uploading the NFT = <code>SEND</code> transaction or <code>send_commit</code></li>
<li>transferring ownership from Sajjad to Mo = <code>TRANSFER</code> transaction</li>
</ol>
<p>Resdb uses public key cryptography to register and maintain the integrity and security of assets. Each asset has to be signed with the owner's private key. This provides surity that the owner of the asset is the one making the transactions.</p>
<p>Each transactions generates a unique hash called <code>transaction ID</code>.</p>
<h2><a class="anchor" id="autotoc_md203"></a>
Creating and Transferring Assets</h2>
<h4><a class="anchor" id="autotoc_md204"></a>
Importing the important stuff</h4>
<div class="fragment"><div class="line"><span class="keyword">from</span> resdb_driver <span class="keyword">import</span> Resdb</div>
<div class="line"><span class="keyword">from</span> <a class="code hl_namespace" href="../../dd/d8e/namespaceresdb__driver_1_1crypto.html">resdb_driver.crypto</a> <span class="keyword">import</span> generate_keypair</div>
<div class="ttc" id="anamespaceresdb__driver_1_1crypto_html"><div class="ttname"><a href="../../dd/d8e/namespaceresdb__driver_1_1crypto.html">resdb_driver.crypto</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/d65/resdb__driver_2crypto_8py_source.html#l00001">crypto.py:1</a></div></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md205"></a>
Generating keys</h4>
<div class="fragment"><div class="line">Sajjad, Mo = generate_keypair(), generate_keypair()</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md206"></a>
Set up root url</h4>
<div class="fragment"><div class="line">root_url = <span class="stringliteral">&#39;https://resdb_url:8080&#39;</span></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md207"></a>
PART 1: Creating the Asset and registering it under Sajjad's ownership</h4>
<div class="fragment"><div class="line">db = Nesres(root_url)</div>
<div class="line">painting_asset = {</div>
<div class="line">    <span class="stringliteral">&#39;data&#39;</span>: {</div>
<div class="line">        <span class="stringliteral">&#39;painting&#39;</span>: {</div>
<div class="line">            <span class="stringliteral">&#39;serialized_img&#39;</span>: <span class="stringliteral">&#39;qwertyuioplkjhgfdazxcvbnm&#39;</span> <span class="comment"># everything under data is immutable stuff</span></div>
<div class="line">            <span class="stringliteral">&#39;name&#39;</span>: <span class="stringliteral">&#39;New Mona Lisa&#39;</span>,</div>
<div class="line">            <span class="stringliteral">&#39;painter&#39;</span>: <span class="stringliteral">&#39;Sajjad&#39;</span></div>
<div class="line">        },</div>
<div class="line">    },</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">painting_asset_metadata = {</div>
<div class="line">    <span class="stringliteral">&#39;date_started&#39;</span>: <span class="stringliteral">&#39;1/1/2022&#39;</span>,</div>
<div class="line">    <span class="stringliteral">&#39;date_completed&#39;</span>: <span class="stringliteral">&#39;12/3/2022&#39;</span>,</div>
<div class="line">    <span class="stringliteral">&#39;price&#39;</span>: <span class="stringliteral">&#39;100&#39;</span>,</div>
<div class="line">    <span class="stringliteral">&#39;currency&#39;</span>: <span class="stringliteral">&#39;USD&#39;</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">prepared_creation_tx = db.transactions.prepare(</div>
<div class="line">    operation=’CREATE’,</div>
<div class="line">    signers=Sajjad.public_key,</div>
<div class="line">    asset=painting_asset,</div>
<div class="line">    metadata=painting_asset_metadata</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">fulfilled_creation_tx = db.transactions.fulfill(</div>
<div class="line">    prepared_creation_tx,</div>
<div class="line">    private_keys=Sajjad.private_key</div>
<div class="line">)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md208"></a>
Upload the asset to the database</h4>
<div class="fragment"><div class="line">sent_creation_tx = db.transactions.send_commit(fulfilled_creation_tx)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md209"></a>
PART 2: preparing the transfering of asset ownership from Sajjad to Mo</h4>
<div class="fragment"><div class="line">txid = fulfilled_creation_tx[<span class="stringliteral">&#39;id&#39;</span>] <span class="comment"># In reality this transaction id and asset details needs to be fetched from the database</span></div>
<div class="line">asset_id = txid</div>
<div class="line">transfer_asset = {</div>
<div class="line">    <span class="stringliteral">&#39;id&#39;</span>: asset_id</div>
<div class="line">}</div>
<div class="line">output_index = 0</div>
<div class="line">output = fulfilled_creation_tx[<span class="stringliteral">&#39;outputs&#39;</span>][output_index]</div>
<div class="line">transfer_input = {</div>
<div class="line">    <span class="stringliteral">&#39;fulfillment&#39;</span>: output[<span class="stringliteral">&#39;condition&#39;</span>][<span class="stringliteral">&#39;details&#39;</span>],</div>
<div class="line">    <span class="stringliteral">&#39;fulfills&#39;</span>: {</div>
<div class="line">        ‘output_index’: output_index,</div>
<div class="line">        ‘transaction_id’: fulfilled_creation_tx[<span class="stringliteral">&#39;id&#39;</span>]</div>
<div class="line">    },</div>
<div class="line">    <span class="stringliteral">&#39;owners_before&#39;</span>: output[<span class="stringliteral">&#39;public_keys&#39;</span>]</div>
<div class="line">}</div>
<div class="line">prepared_transfer_tx = db.transactions.prepare(</div>
<div class="line">    operation=’TRANSFER’,</div>
<div class="line">    asset=transfer_asset,</div>
<div class="line">    inputs=transfer_input,</div>
<div class="line">    recipients=Mo.public_key,</div>
<div class="line">)</div>
<div class="line">fulfilled_transfer_tx = db.transactions.fulfill(</div>
<div class="line">    prepared_transfer_tx,</div>
<div class="line">    private_keys=Sajjad.private_key,</div>
<div class="line">)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md210"></a>
competing the TRANSFER operatiom with a commit</h4>
<p><code>sent_transfer_tx = resdb.transactions.send_commit(fulfilled_transfer_tx)</code></p>
<h4><a class="anchor" id="autotoc_md211"></a>
Comfirming</h4>
<div class="fragment"><div class="line">print(“Is Mo the owner of the painting?”,</div>
<div class="line">    sent_transfer_tx[‘outputs’][0][‘public_keys’][0] == Mo.public_key)</div>
<div class="line">print(“Was Sajjad the previous owner of the painting?”,</div>
<div class="line">    fulfilled_transfer_tx[‘inputs’][0][‘owners_before’][0] == Sajjad.public_key)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md212"></a>
!Note!</h4>
<p>We are using the same transaction model as <a href="https://github.com/bigchaindb/BEPs/tree/master/13">bigchaindb transaction model</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
