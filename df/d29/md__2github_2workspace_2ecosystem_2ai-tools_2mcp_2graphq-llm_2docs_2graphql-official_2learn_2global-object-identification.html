#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#  http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ResilientDB: global-object-identification</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('df/d29/md__2github_2workspace_2ecosystem_2ai-tools_2mcp_2graphq-llm_2docs_2graphql-official_2learn_2global-object-identification.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">global-object-identification</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md923"></a>
Global Object Identification</h1>
<blockquote class="doxtable">
<p>Consistent object access enables simple caching and object lookups </p>
</blockquote>
<p>To provide options for GraphQL clients to elegantly handle caching and data refetching, GraphQL servers need to expose object identifiers in a standardized way.</p>
<p>For this to work, a client will need to query via a standard mechanism to request an object by ID. Then, in the response, the schema will need to provide a standard way of providing these IDs.</p>
<p>Because little is known about the object other than its ID, we call these objects "nodes." Here is an example query for a node:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  node(id: &quot;4&quot;) {</div>
<div class="line">    id</div>
<div class="line">    ... on User {</div>
<div class="line">      name</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li>The GraphQL schema is formatted to allow fetching any object via the <code>node</code> field on the root query object. This returns objects which conform to a "Node" <a href="../..//learn/schema/#interfaces">interface</a>.</li>
<li>The <code>id</code> field can be extracted out of the response safely, and can be stored for re-use via caching and refetching.</li>
<li>Clients can use interface fragments to extract additional information specific to the type which conform to the node interface. In this case a "User".</li>
</ul>
<p>The Node interface looks like:</p>
<div class="fragment"><div class="line"># An object with a Globally Unique ID</div>
<div class="line">interface Node {</div>
<div class="line">  # The ID of the object.</div>
<div class="line">  id: ID!</div>
<div class="line">}</div>
</div><!-- fragment --><p>With a User conforming via:</p>
<div class="fragment"><div class="line">type User implements Node {</div>
<div class="line">  id: ID!</div>
<div class="line">  # Full name</div>
<div class="line">  name: String!</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md924"></a>
Specification</h2>
<p>Everything below describes with more formal requirements a specification around object identification in order to conform to ensure consistency across server implementations. These specifications are based on how a server can be compliant with the <a href="https://facebook.github.io/relay/">Relay</a> API client, but can be useful for any client.</p>
<h2><a class="anchor" id="autotoc_md925"></a>
Reserved Types</h2>
<p>A GraphQL server compatible with this spec must reserve certain types and type names to support the consistent object identification model. In particular, this spec creates guidelines for the following types:</p>
<ul>
<li>An interface named <code>Node</code>.</li>
<li>The <code>node</code> field on the root query type.</li>
</ul>
<h2><a class="anchor" id="autotoc_md926"></a>
Node Interface</h2>
<p>The server must provide an interface called <code>Node</code>. That interface must include exactly one field, called <code>id</code> that returns a non-null <code>ID</code>.</p>
<p>This <code>id</code> should be a globally unique identifier for this object, and given just this <code>id</code>, the server should be able to refetch the object.</p>
<h3><a class="anchor" id="autotoc_md927"></a>
Introspection</h3>
<p>A server that correctly implements the above interface will accept the following introspection query, and return the provided response:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  __type(name: &quot;Node&quot;) {</div>
<div class="line">    name</div>
<div class="line">    kind</div>
<div class="line">    fields {</div>
<div class="line">      name</div>
<div class="line">      type {</div>
<div class="line">        kind</div>
<div class="line">        ofType {</div>
<div class="line">          name</div>
<div class="line">          kind</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>yields</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;__type&quot;: {</div>
<div class="line">    &quot;name&quot;: &quot;Node&quot;,</div>
<div class="line">    &quot;kind&quot;: &quot;INTERFACE&quot;,</div>
<div class="line">    &quot;fields&quot;: [</div>
<div class="line">      {</div>
<div class="line">        &quot;name&quot;: &quot;id&quot;,</div>
<div class="line">        &quot;type&quot;: {</div>
<div class="line">          &quot;kind&quot;: &quot;NON_NULL&quot;,</div>
<div class="line">          &quot;ofType&quot;: {</div>
<div class="line">            &quot;name&quot;: &quot;ID&quot;,</div>
<div class="line">            &quot;kind&quot;: &quot;SCALAR&quot;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    ]</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md928"></a>
Node root field</h2>
<p>The server must provide a root field called <code>node</code> that returns the <code>Node</code> interface. This root field must take exactly one argument, a non-null ID named <code>id</code>.</p>
<p>If a query returns an object that implements <code>Node</code>, then this root field should refetch the identical object when value returned by the server in the <code>Node</code>'s <code>id</code> field is passed as the <code>id</code> parameter to the <code>node</code> root field.</p>
<p>The server must make a best effort to fetch this data, but it may not always be possible; for example, the server may return a <code>User</code> with a valid <code>id</code>, but when the request is made to refetch that user with the <code>node</code> root field, the user's database may be unavailable, or the user may have deleted their account. In this case, the result of querying this field should be <code>null</code>.</p>
<h3><a class="anchor" id="autotoc_md929"></a>
Introspection</h3>
<p>A server that correctly implements the above requirement will accept the following introspection query, and return a response that contains the provided response.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  __schema {</div>
<div class="line">    queryType {</div>
<div class="line">      fields {</div>
<div class="line">        name</div>
<div class="line">        type {</div>
<div class="line">          name</div>
<div class="line">          kind</div>
<div class="line">        }</div>
<div class="line">        args {</div>
<div class="line">          name</div>
<div class="line">          type {</div>
<div class="line">            kind</div>
<div class="line">            ofType {</div>
<div class="line">              name</div>
<div class="line">              kind</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>yields</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;__schema&quot;: {</div>
<div class="line">    &quot;queryType&quot;: {</div>
<div class="line">      &quot;fields&quot;: [</div>
<div class="line">        // This array may have other entries</div>
<div class="line">        {</div>
<div class="line">          &quot;name&quot;: &quot;node&quot;,</div>
<div class="line">          &quot;type&quot;: {</div>
<div class="line">            &quot;name&quot;: &quot;Node&quot;,</div>
<div class="line">            &quot;kind&quot;: &quot;INTERFACE&quot;</div>
<div class="line">          },</div>
<div class="line">          &quot;args&quot;: [</div>
<div class="line">            {</div>
<div class="line">              &quot;name&quot;: &quot;id&quot;,</div>
<div class="line">              &quot;type&quot;: {</div>
<div class="line">                &quot;kind&quot;: &quot;NON_NULL&quot;,</div>
<div class="line">                &quot;ofType&quot;: {</div>
<div class="line">                  &quot;name&quot;: &quot;ID&quot;,</div>
<div class="line">                  &quot;kind&quot;: &quot;SCALAR&quot;</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          ]</div>
<div class="line">        }</div>
<div class="line">      ]</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md930"></a>
Field stability</h2>
<p>If two objects appear in a query, both implementing <code>Node</code> with identical IDs, then the two objects must be equal.</p>
<p>For the purposes of this definition, object equality is defined as follows:</p>
<ul>
<li>If a field is queried on both objects, the result of querying that field on the first object must be equal to the result of querying that field on the second object.<ul>
<li>If the field returns a scalar, equality is defined as is appropriate for that scalar.</li>
<li>If the field returns an enum, equality is defined as both fields returning the same enum value.</li>
<li>If the field returns an object, equality is defined recursively as per the above.</li>
</ul>
</li>
</ul>
<p>For example:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  fourNode: node(id: &quot;4&quot;) {</div>
<div class="line">    id</div>
<div class="line">    ... on User {</div>
<div class="line">      name</div>
<div class="line">      userWithIdOneGreater {</div>
<div class="line">        id</div>
<div class="line">        name</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fiveNode: node(id: &quot;5&quot;) {</div>
<div class="line">    id</div>
<div class="line">    ... on User {</div>
<div class="line">      name</div>
<div class="line">      userWithIdOneLess {</div>
<div class="line">        id</div>
<div class="line">        name</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>might return:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;fourNode&quot;: {</div>
<div class="line">    &quot;id&quot;: &quot;4&quot;,</div>
<div class="line">    &quot;name&quot;: &quot;Mark Zuckerberg&quot;,</div>
<div class="line">    &quot;userWithIdOneGreater&quot;: {</div>
<div class="line">      &quot;id&quot;: &quot;5&quot;,</div>
<div class="line">      &quot;name&quot;: &quot;Chris Hughes&quot;</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  &quot;fiveNode&quot;: {</div>
<div class="line">    &quot;id&quot;: &quot;5&quot;,</div>
<div class="line">    &quot;name&quot;: &quot;Chris Hughes&quot;,</div>
<div class="line">    &quot;userWithIdOneLess&quot;: {</div>
<div class="line">      &quot;id&quot;: &quot;4&quot;,</div>
<div class="line">      &quot;name&quot;: &quot;Mark Zuckerberg&quot;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Because <code>fourNode.id</code> and <code>fiveNode.userWithIdOneLess.id</code> are the same, we are guaranteed by the conditions above that <code>fourNode.name</code> must be the same as <code>fiveNode.userWithIdOneLess.name</code>, and indeed it is.</p>
<h2><a class="anchor" id="autotoc_md931"></a>
Plural identifying root fields</h2>
<p>Imagine a root field named <code>username</code>, that takes a user's username and returns the corresponding user:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  username(username: &quot;zuck&quot;) {</div>
<div class="line">    id</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>might return:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;username&quot;: {</div>
<div class="line">    &quot;id&quot;: &quot;4&quot;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Clearly, we can link up the object in the response, the user with ID 4, with the request, identifying the object with username "zuck". Now imagine a root field named <code>usernames</code>, that takes a list of usernames and returns a list of objects:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  usernames(usernames: [&quot;zuck&quot;, &quot;moskov&quot;]) {</div>
<div class="line">    id</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>might return:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;usernames&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;id&quot;: &quot;4&quot;</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;id&quot;: &quot;6&quot;</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>For clients to be able to link the usernames to the responses, it needs to know that the array in the response will be the same size as the array passed as an argument, and that the order in the response will match the order in the argument. We call these <em>plural identifying root fields</em>, and their requirements are described below.</p>
<h3><a class="anchor" id="autotoc_md932"></a>
Fields</h3>
<p>A server compliant with this spec may expose root fields that accept a list of input arguments, and returns a list of responses. For spec-compliant clients to use these fields, these fields must be <em>plural identifying root fields</em>, and obey the following requirements.</p>
<p>NOTE Spec-compliant servers may expose root fields that are not <em>plural identifying root fields</em>; the spec-compliant client will just be unable to use those fields as root fields in its queries.</p>
<p><em>Plural identifying root fields</em> must have a single argument. The type of that argument must be a non-null list of non-nulls. In our <code>usernames</code> example, the field would take a single argument named <code>usernames</code>, whose type (using our type system shorthand) would be <code>[String!]!</code>.</p>
<p>The return type of a <em>plural identifying root field</em> must be a list, or a non-null wrapper around a list. The list must wrap the <code>Node</code> interface, an object that implements the <code>Node</code> interface, or a non-null wrapper around those types.</p>
<p>Whenever the <em>plural identifying root field</em> is used, the length of the list in the response must be the same as the length of the list in the arguments. Each item in the response must correspond to its item in the input; more formally, if passing the root field an input list <code>Lin</code> resulted in output value <code>Lout</code>, then for an arbitrary permutation <code>P</code>, passing the root field <code>P(Lin)</code> must result in output value <code>P(Lout)</code>.</p>
<p>Because of this, servers are advised to not have the response type wrap a non-null wrapper, because if it is unable to fetch the object for a given entry in the input, it still must provide a value in the output for that input entry; <code>null</code> is a useful value for doing so. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
